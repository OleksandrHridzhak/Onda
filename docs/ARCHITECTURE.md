# ĞÑ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Onda ğŸ—ï¸

> ĞšĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ Ğ¾Ğ³Ğ»ÑĞ´ Ğ´Ğ»Ñ ÑˆĞ²Ğ¸Ğ´ĞºĞ¾Ğ³Ğ¾ Ğ¾Ñ€Ñ–Ñ”Ğ½Ñ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ² ĞºĞ¾Ğ´Ñ–.

## Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñƒ

```
ğŸ“¦ Onda
â”œâ”€ main.js              â† Electron entry (desktop shell)
â”œâ”€ preload.js           â† Electron preload (IPC bridge)
â”œâ”€ api/                 â† IPC handlers Ğ´Ğ»Ñ Ğ´ĞµÑĞºÑ‚Ğ¾Ğ¿Ñƒ
â”œâ”€ render/              â† React frontend (ÑĞ¿Ñ–Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ´Ğ»Ñ desktop/mobile)
â”‚   â””â”€ src/
â”‚       â”œâ”€ components/  â† UI ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¸
â”‚       â”œâ”€ services/    â† IndexedDB, sync, Ğ»Ğ¾Ğ³Ñ–ĞºĞ°
â”‚       â”œâ”€ store/       â† Redux slices
â”‚       â””â”€ types/       â† TypeScript Ñ‚Ğ¸Ğ¿Ğ¸
â”œâ”€ mobile/              â† Capacitor config Ğ´Ğ»Ñ Android
â””â”€ sync-server/         â† Express backend Ğ´Ğ»Ñ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ—
```

## ĞŸĞ¾Ñ‚Ñ–Ğº Ğ´Ğ°Ğ½Ğ¸Ñ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  React UI   â”‚ â†â†’  â”‚   Redux     â”‚ â†â†’  â”‚  IndexedDB  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†•
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  SyncService  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†•
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  sync-server â†’ MongoDB â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿: Local-first**
- Ğ’ÑÑ– Ğ´Ğ°Ğ½Ñ– ÑĞ¿Ğ¾Ñ‡Ğ°Ñ‚ĞºÑƒ Ğ·Ğ±ĞµÑ€Ñ–Ğ³Ğ°ÑÑ‚ÑŒÑÑ Ğ² IndexedDB
- Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ²Ñ–Ğ´Ğ±ÑƒĞ²Ğ°Ñ”Ñ‚ÑŒÑÑ Ñƒ Ñ„Ğ¾Ğ½Ñ–
- ĞŸÑ€Ğ°Ñ†ÑÑ” Ğ¾Ñ„Ğ»Ğ°Ğ¹Ğ½

## ĞšĞ»ÑÑ‡Ğ¾Ğ²Ñ– Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ–

### Frontend (`render/src/`)

| ĞœĞ¾Ğ´ÑƒĞ»ÑŒ | ĞŸÑ€Ğ¸Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ |
|--------|-------------|
| `services/syncService.ts` | Ğ“Ğ¾Ğ»Ğ¾Ğ²Ğ½Ğ¸Ğ¹ ÑĞµÑ€Ğ²Ñ–Ñ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ— |
| `services/indexedDB.js` | Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğµ ÑÑ…Ğ¾Ğ²Ğ¸Ñ‰Ğµ Ğ´Ğ°Ğ½Ğ¸Ñ… |
| `store/slices/` | Redux state (theme, pomodoro) |
| `components/features/Table/` | ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¸Ğ¹ Ğ¿Ğ»Ğ°Ğ½ĞµÑ€ Ğ·Ğ°Ğ²Ğ´Ğ°Ğ½ÑŒ |
| `components/features/Calendar/` | ĞšĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€Ğ½Ğ¸Ğ¹ Ğ²Ğ¸Ğ³Ğ»ÑĞ´ |

### Backend (`sync-server/src/`)

| ĞœĞ¾Ğ´ÑƒĞ»ÑŒ | ĞŸÑ€Ğ¸Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ |
|--------|-------------|
| `controllers/syncController.ts` | Push/pull Ğ»Ğ¾Ğ³Ñ–ĞºĞ° |
| `database/mongodb.ts` | MongoDB Atlas Ğ¿Ñ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ |
| `middleware/auth.ts` | ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ñ–Ñ Ğ·Ğ° secret key |

### Desktop (`main.js`, `api/`)

| ĞœĞ¾Ğ´ÑƒĞ»ÑŒ | ĞŸÑ€Ğ¸Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ |
|--------|-------------|
| `main.js` | Ğ¡Ñ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ½Ñ Ğ²Ñ–ĞºĞ½Ğ° Electron |
| `api/ipcWindowsHandlers.js` | Window controls, notifications |

## Sync Strategy

```
Client                          Server
  â”‚                               â”‚
  â”‚  1. PUSH (ÑĞºÑ‰Ğ¾ Ñ” Ğ·Ğ¼Ñ–Ğ½Ğ¸)       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
  â”‚                               â”‚  (server version++)
  â”‚  2. PULL (Ğ¿ĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ° Ğ²ĞµÑ€ÑÑ–Ñ—)   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
  â”‚                               â”‚
  â”‚  3. MERGE (ÑĞºÑ‰Ğ¾ conflict)     â”‚
  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                               â”‚
```

**Conflict resolution:** Last-write-wins (Ğ¾ÑÑ‚Ğ°Ğ½Ğ½Ñ–Ğ¹ Ğ·Ğ°Ğ¿Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞ¼Ğ°Ğ³Ğ°Ñ”)

## Ğ”Ğµ ÑˆÑƒĞºĞ°Ñ‚Ğ¸ ĞºĞ¾Ğ´?

| Ğ¥Ğ¾Ñ‡Ñƒ Ğ·Ğ¼Ñ–Ğ½Ğ¸Ñ‚Ğ¸... | Ğ”Ğ¸Ğ²Ğ¸ÑÑŒ ÑÑĞ´Ğ¸ |
|-----------------|-------------|
| UI Ğ·Ğ°Ğ²Ğ´Ğ°Ğ½ÑŒ | `render/src/components/features/Table/` |
| ĞšĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€ | `render/src/components/features/Calendar/` |
| ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ | `render/src/components/features/Settings/` |
| Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ | `render/src/services/sync/` + `sync-server/src/` |
| Ğ¢ĞµĞ¼Ğ¸ | `render/src/store/slices/newThemeSlice.ts` |
| Ğ”ĞµÑĞºÑ‚Ğ¾Ğ¿ Ğ²Ñ–ĞºĞ½Ğ¾ | `main.js` + `api/ipcWindowsHandlers.js` |
